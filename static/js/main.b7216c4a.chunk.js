(this.webpackJsonppopup=this.webpackJsonppopup||[]).push([[0],{140:function(e,t,n){e.exports=n(318)},145:function(e,t,n){},147:function(e,t,n){},318:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(4),s=n.n(o),c=(n(145),n(64)),i=n(65),l=n(69),u=n(66),p=n(70),d=(n(146),n(324)),h=(n(147),n(137)),f=n(21),m=n.n(f),y=n(323),g=n(319),v=n(325),k=n(320),w=n(10),b=n(321),E=n(101),C=n(121),x=n.n(C),S=n(71),O=n(122),j=n(43),P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";return chrome.runtime.getURL(e)},A="https://khoazero123.github.io/give-access-url/index.html",F=["edfofjonpcdadngmpheilifigfaoafle","eidgdkoamddnlbmfadangiakgdjngnmc"],I=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),n.props.form.validateFields((function(e,t){e||console.log("Received values of form: ",t)}))},n.setPassword=function(e){e=""!==e?e:void 0,n.setState({password:e,encrypting:!0}),n.encryptCookie().then((function(){n.setState({encrypting:!1})})),n.setState({password:e})},n.copyToClipboard=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"local",t=n.getEncryptCookie(),a="local"===e?P("popup/index.html"):A,r="".concat(a,"?token=").concat(t);r.length>2e3&&alert("Data too large. No more 2000 chars"),t&&(x()(r),y.a.info("Copied to clipboard"),n.setState({copied:!0}))},n.state={url:"",domain:"",cookies:[],encrypted:"",encrypting:!1,password:void 0,defaultPassword:"password",copied:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"decryptCookie",value:function(e){var t,n,a,r;return m.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:try{n=j.AES.decrypt(e,this.state.defaultPassword),t=JSON.parse(n.toString(j.enc.Utf8))}catch(s){if(null!=(a=prompt("Please enter the password","")))try{r=j.AES.decrypt(e,a),t=r.toString(j.enc.Utf8)}catch(s){alert("Wrong password!")}}t&&this.setCookies(t);case 2:case"end":return o.stop()}}),null,this)}},{key:"encryptCookie",value:function(){var e,t,n=this;return m.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,m.a.awrap(this.getCurrentUrl());case 2:return e=a.sent,a.next=5,m.a.awrap(this.getDomain());case 5:return t=a.sent,this.setState({domain:t,url:e}),a.abrupt("return",new Promise((function(e){chrome.cookies.getAll({domain:t||""},(function(t){var a=JSON.stringify({url:n.state.url,cookies:n.state.cookies}),r="undefined"!==typeof n.state.password?n.state.password:n.state.defaultPassword,o=j.AES.encrypt(a,r).toString();return n.setState({cookies:t,encrypted:o}),e(o)}))})));case 8:case"end":return a.stop()}}),null,this)}},{key:"getEncryptCookie",value:function(){return this.state.encrypted}},{key:"getParameterByName",value:function(e,t){var n=S.parse(t,!0).query[e];return((Array.isArray(n)?n[0]:n)||"").replace(/\s/g,"+")}},{key:"getDomain",value:function(){var e,t,n;return m.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,m.a.awrap(this.getCurrentUrl());case 2:return e=a.sent,t=S.parse(e),n=t.host,a.abrupt("return",n||"");case 5:case"end":return a.stop()}}),null,this)}},{key:"getCurrentUrl",value:function(){var e,t;return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!chrome||!chrome.tabs){n.next=8;break}return n.next=3,m.a.awrap(this.getCurrentTab());case 3:return e=n.sent,t=e.url,n.abrupt("return",t);case 8:return n.abrupt("return",window.location.href);case 9:case"end":return n.stop()}}),null,this)}},{key:"getCurrentTab",value:function(){return new Promise((function(e){chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(t){e(t[0])}))}))}},{key:"setCookies",value:function(e){var t,n,a;return m.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:t=e.url,n=e.cookies,a=this,Object(O.forEach)(n,(function(e){var n=this.async();delete e.hostOnly,delete e.session,chrome.cookies.set(Object(h.a)({url:t},e),(function(e){e&&console.log("Set cookie ".concat(e.name,": ").concat(e.value)),n()}))}),(function(){console.log("Redriect to ".concat(t)),a.getCurrentTab().then((function(e){}))}));case 3:case"end":return r.stop()}}),null,this)}},{key:"componentDidMount",value:function(){var e,t;return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.a.awrap(this.getCurrentUrl());case 2:return e=n.sent,n.next=5,m.a.awrap(this.getParameterByName("token",e));case 5:t=n.sent,console.log(S.parse(e,!0)),console.log({urlCurrentTab:e,token:t}),t?(this.checkIsExtensionInstalled(),this.decryptCookie(t)):this.encryptCookie();case 9:case"end":return n.stop()}}),null,this)}},{key:"checkIsExtensionInstalled",value:function(){F.forEach((function(e){try{chrome.runtime.sendMessage(e,{data:{message:"Send from ".concat(window.location.href)}},(function(e){console.log({response:e})}))}catch(t){console.log(t.message)}}))}},{key:"render",value:function(){var e=this,t=this.props.form,n=t.getFieldDecorator,a=t.getFieldError,o=(0,t.isFieldTouched)("password")&&a("password");return console.log({state:this.state}),r.a.createElement(g.a,{layout:"horizontal",onSubmit:this.handleSubmit},r.a.createElement(v.a,{message:"Found ".concat(this.state.cookies.length," cookies of ").concat(this.state.domain),type:"success"}),r.a.createElement(g.a.Item,null,r.a.createElement(k.a,{prefix:r.a.createElement(w.a,{type:"link",style:{color:"rgba(0,0,0,.25)"}}),type:"text",disabled:!0,value:this.state.url})),r.a.createElement(g.a.Item,{validateStatus:o?"error":"",help:o||""},n("password",{rules:[{required:!1,message:"Please input your Password!"}]})(r.a.createElement(k.a,{prefix:r.a.createElement(w.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password (option)",onChange:function(t){return e.setPassword(t.target.value)}}))),r.a.createElement(g.a.Item,{style:{textAlign:"center"}},r.a.createElement("div",null,r.a.createElement(b.a,{placement:"top",title:"For those who have installed the extension"},r.a.createElement(E.a,{type:"primary",icon:"copy",onClick:function(){return e.copyToClipboard("local")},disabled:this.state.encrypting},"Copy local link"))),r.a.createElement("div",null,r.a.createElement(b.a,{placement:"bottom",title:"For anyone"},r.a.createElement(E.a,{type:"primary",icon:"copy",onClick:function(){return e.copyToClipboard("public")},disabled:this.state.encrypting},"Copy public link")))))}}]),t}(a.Component),T=g.a.create({name:"horizontal_login"})(I),U=d.a.Header,D=d.a.Footer,N=d.a.Content,B=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(d.a,{style:{width:350,margin:"auto"}},r.a.createElement(U,{style:{color:"#f5deb3",textAlign:"center"}},"Access URL"),r.a.createElement(N,{style:{padding:5,margin:"auto"}},r.a.createElement(T,null)),r.a.createElement(D,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[140,1,2]]]);
//# sourceMappingURL=main.b7216c4a.chunk.js.map